<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="personal">
	<sql id="select">
		memSeq, memId, name, gender, phone, platform, auth, delYn, benYn, joinDate
	</sql>
	
	<select id="personalInfo">
		select m.mem_seq,
		       m.mem_id,
		       m.name,
		       m.gender,
		       m.phone,
		       m.platform,
		       m.auth,
		       m.del_yn,
		       m.ben_yn,
		       m.join_date,
		       vt.volun_heat,
		       vt.volun_addtime,
		       vt.volun_noshow
		from member m
		join volunteer_time vt ON m.mem_seq = vt.mem_seq;
	</select>
	
<!-- 	selectPersonal, selectVolunteerProceedList, timeRecord-->	
	<select id="selectVolunteerProceedList" parameterType="MemberVO" resultType="VolunteerProceedVO">
		select *
			from volunteer_proceed
			where mem_seq= ${memSeq}
	</select>

	<update id="timeRecord">
		update 
		from volunteer_proceed
	
	</update>

	<select id="totalCount" parameterType="ReviewSearchVO" resultType="int">
		select count(*)
		<choose>
    		<when test="codeNumber != null and codeNumber != ''">
    			from review_board r inner join category c
				on r.review_seq = c.review_seq
    		</when>
    		<otherwise>
    			from review_board
    		</otherwise>
    	</choose>
		<include refid="whereClause" />
	</select>

	<select id="selectReviewList" parameterType="ReviewSearchVO" resultType="ReviewBoardVO">
		<include refid="paging.top" />
		select *
    	<choose>
    		<when test="codeNumber != null and codeNumber != ''">
    			from review_board r inner join category c
				on r.review_seq = c.review_seq
    		</when>
    		<otherwise>
    			from review_board
    		</otherwise>
    	</choose>
		<include refid="whereClause" />
		<choose>
			<when test="sort != null and sort != ''">
				order by ${sort}
			</when>
			<otherwise>
				<choose>
					<when test="codeNumber != null and codeNumber != ''">
						order by r.review_seq desc
					</when>
					<otherwise>
						order by review_seq desc
					</otherwise>
			
				</choose>
				
			</otherwise>
		</choose>
		<include refid="paging.bottom" />
	</select>
	
	
	<select id="selectPopularList" resultType="ReviewBoardVO">
		select review_title, mod_date
		from (
			select * from review_board
			order by recom_count desc
		)
		<![CDATA[
			where rownum <= 3
		]]>
	</select>
	
	<select id="selectOne" parameterType="ReviewSearchVO" resultType="ReviewBoardVO">
		select *
		from review_board
		where review_seq = #{reviewSeq}
	</select>
	
	
</mapper>